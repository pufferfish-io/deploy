---
name: "ğŸš€ Deploy Ingress: demo.pufferfish.ru"
on:
  push:
    paths:
      - k8s/ingress/hello-demo-ingress.yaml
  workflow_dispatch: null
jobs:
  apply-ingress:
    name: ğŸ”„ Apply Ingress for demo
    runs-on: self-hosted
    env:
      KUBECONFIG: /etc/rancher/k3s/k3s.yaml
    steps:
      - name: ğŸ§¾ Checkout repository
        uses: actions/checkout@v4
      - name: ğŸ”§ Ensure namespace
        run: |
          kubectl get ns demo || kubectl create ns demo
      - name: "ğŸ“¤ Deploy Ingress: demo.pufferfish.ru"
        run: |
          echo "â³ Applying Ingress..."
          kubectl apply -f k8s/ingress/hello-demo-ingress.yaml
      - name: ğŸ“‹ Show result
        run: |
          echo "âœ… Ingresses in demo namespace:"
          kubectl get ingress -n demo -o wide
